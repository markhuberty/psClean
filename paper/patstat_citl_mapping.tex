\documentclass[11pt]{article}
\usepackage{natbib}
\usepackage[usenames, dvipsnames, svgnames, table]{xcolor}
\usepackage[dvipdfm,colorlinks=true,urlcolor=DarkBlue,linkcolor=DarkBlue,bookmarks=false,citecolor=DarkBlue]{hyperref}

\usepackage[pdftex]{graphicx}
\usepackage{fancyhdr}
\usepackage[T1]{fontenc}
\usepackage{palatino}
\usepackage[utf8]{inputenc}
%\usepackage[super]{nth}
\usepackage{setspace}
% \usepackage{placeins}
% \usepackage{subfigure}
% \usepackage{multirow}
\usepackage{rotating}
\usepackage{marvosym}  % Used for euro symbols with \EUR
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\usepackage{longtable} %% Allows the use of the longtable format produced by xl2latex.rb
\usepackage{lscape} %% Allows landscape orientation of tables
% \usepackage{appendix} %% Allows customization of the appendix properties
\setcounter{tocdepth}{1} %% Restricts the table of contents to the section header level entries only


\usepackage{geometry}
\geometry{letterpaper}
\usepackage{amsmath}
\graphicspath{{../figures/}}


\title{A scaleable approach to emissions-innovation record linkage\thanks{This
    work was supported by the SIMPATIC project under the Seventh European Union Framework Programme. Mark Huberty received additional support from the United States
    Environmental Protection Agency STAR fellowship for work relating to
    the political economy of green innovation. We thank in particular
    Lee Fleming, Forest Gregg, and Derek Elder for their contributions
    to disambiguation approaches. All errors remain our own.}\\
  Working Paper}
\author{Mark Huberty\thanks{University of California,
    Berkeley. \texttt{markhuberty@berkeley.edu}}, Amma
  Serwaah\thanks{Bruegel.}, and Georg Zachmann\thanks{Bruegel. \texttt{georg.zachmann@bruegel.org}}}
\date{\today}

\begin{document}
\maketitle
\doublespacing

\begin{abstract}
  This paper reports an approach to linking data on European emitters
  to data on their innovation practices. We illustrate a
  straightforward approach to record linkage between the European
  Union Community Integrated Transaction Log (CITL) and the PATSTAT
  international patent database. We show how that record linkage can
  be maintained with minimal human input. 
\end{abstract}

\section{Introduction}
\label{sec:introduction}

The European Union Emissions Trading Scheme (ETS) is supposed to
minimise the cost of achieving a predefined abatement level in the
long-run. The ETS emissions price should therefore incentivize
long term as well as short term investments in emissions
mitigation. Innovation in low-emissions technologies is a critical
component of the ETS' long-term focus.

Estimating whether the ETS has induced additional investment in
low-emissions innovation is complicated by several data
problems. First, innovation data are readily available, but they pose
significant data quality barriers. Second, linking patterns of
innovation to exposure to the emissions price itself requires a means
of linking data on innovative activity to data on exposure to the
European emissions price. Given the very large number of European
firms relative to the number of firms regulated under the ETS,
establishing these links amounts to looking for a needle in a
haystack. Finally, many firms may separate business units most exposed
to the ETS permit price from those most directly engaged in
innovation. Hence any linkage strategy must capture both direct and
subsidiary connections, lest it underestimate the innovation effect of
the EU ETS.

This paper describes an approach to linking innovation and emissions
data for the European Union. We \citep{huberty2013a} have previously
introduced a flexible, scaleable approach to disambiguation of the
PATSTAT database on international patenting activity. This paper builds on that result, providing a
machine-learning based approach to record linkage between the
disambiguated PATSTAT data and firms regulated by the European Union
Emissions Trading Scheme. We
illustrate that this approach can achieve relatively high levels of
accuracy with minimal human input.

\section{Linking innovation and regulation}
\label{sec:linking-patstat-citl}

We implement a three-stage process for matching firms regulated under
the European Emissions Trading Scheme to their innovation activities
as they appear in patent data. We first describe a means of
establishing a pool of likely matches. We then demonstrate a supervised
learning approach to filtering these likely matches. We provide
estimates that this approach is highly accurate compared with
manually-labeled data. Finally, we provide summary statistics showing,
in broad terms, how the pattern of identifiable links between
regulated and innovating firms breaks down across European
member states and regulated sectors. 

\subsection{Data}
\label{sec:data}

We draw on two different data sets for the purposes of record
linkage. First, as described in \cite{huberty2013a}, we disambiguate
the October 2011 version of the PATSTAT database for each of the EU-25
countries (excluding Cyprus and Malta). This results in a one-to-many
map between unique individuals and their non-unique occurrences in
PATSTAT. For each unique individual, we consolidate this map to a
single record comprised of the most common name variant and the most
common non-null latitude and longitude pair. 

Second, we use the most recent version of the Community Integrated
Transaction Log (CITL), which tracks regulated firms and emissions
permit allocation under the European Emissions Trading Scheme. The
CITL data represent an official accounting log; hence we assume with
confidence that each account holder is a unique entity, and do not
disambiguate further. Account holders were geo-coded using a fuzzy
geo-coding algorithm as described in \cite{huberty2013a}. Both data
sets were, to the extent possible, standardized for case, punctuation,
and use of name diacritics.

\subsection{Record linkage}
\label{sec:record-linkage}

We use record linkage here to refer to a specific form of data
disambiguation: given two records from two different databases,
identify whether they refer to the same entity. This problem is
related to, but separate from, our earlier work \citep{huberty2013a}
focused on disambiguation \textit{within} a single database. In that
instance, the primary problem was twofold: first, how to find all
versions of the same entity given possibly significant variance in the
format and spelling of inventor names; and second, how to do so with
minimal human intervention and in finite time. We show that the
approach described by \cite{bilenko2006learnable} and implemented in
the \texttt{dedupe} library for Python performed well on both counts.

Matching between the disambiguated patent database and the CITL
account holders' database poses a variant on this problem. The
mismatch between databases in terms of data availability complicates
matters by reducing available data with which to compare records. Even
with the data quality issues discussed in \cite{huberty2013a},
internal comparisons within PATSTAT could draw on (at a minimum) name,
geography, innovation categories, and coauthors to distinguish one
inventor from another. In contrast, matching PATSTAT to CITL can only
draw on name and geography.

Conversely, cross-database matching simplifies the problem by greatly
restricting the set of matches we need to examine. Whereas in the
PATSTAT database the comparison set scaled as $N^2$ for $N$ records in
the PATSTAT data set, the PATSTAT-CITL linkage requires at most $N
\times M$ comparison for $M$ CITL records. Since there are only
approximately ten thousand registered emitters in the Emissions
Trading Scheme, $M \ll N$. This feature greatly diminishes the need
for sophisticated blocking strategies to keep computation tractable.

To match records \textit{across} databases, we implement the following
algorithm. In each case, the PATSTAT data refers to the output of the
\texttt{dedupe} process discussed in \cite{huberty2013a}. That output
consolidated all variants on a unique inventor to a single record by
taking (1) the most common name variant and (2) the most common non-null
latitude/longitude pair:

\begin{enumerate}
\item For each account holder in the CITL database:
  \begin{enumerate}
  \item Select the PATSTAT records filed in the country of origin for
    that account holder
  \item Compute the Levenshtein ratio of the CITL name and each
    PATSTAT name
  \item Return the top $N=3$ closest matches. 
  \end{enumerate}
\item For each potential CITL:PATSTAT match:
  \begin{enumerate}
  \item Compute multiple variants of name similarity between the
    PATSTAT and CITL names. We used the
    Levenshtein edit ratio; and the Jaccard unigram similarity metric
  \item Compute geographic distance as the Haversine great circle
    distance between record pairs\footnote{Each CITL account holder address was
      geo-coded using a city-level geo-coding algorithm. For more
      details on the algorithm, see the \texttt{fuzzygeo} package at \url{https://github.com/markhuberty/fuzzygeo}.}
  \end{enumerate}
\item Label a subset of all possible matches as either match (1) or
  non-match (0), in two steps:
  \begin{enumerate}
  \item Compute an initial set of matches by taking only PATSTAT:CITL
    pairs with exact name matches
  \item Expand the set of matches and non-matches by hand-labeling a
    random subset of pairs from the remaining data. Labeling continued
    until non-matches numbered 25\% of the exact match volume.
  \end{enumerate}
\item Train a support vector classifier on the labeled data, using as
  predictor variables the two name distances (Levenshtein and Jaccard)
  and the geographic distance\footnote{All classification and
    estimation used the \texttt{sklearn} library for python.}
\item Use the classifier to predict matches and
  non-matches for the entire set of potential matches
\end{enumerate}

Classification accuracy was estimated at 92$\pm$1\% via ten-fold
cross-validation. We note several caveats for using this estimation
strategy. First, the labeling rubric should be fairly generous towards
classifying different country subsidiaries together, in order to
capture instances where corporate structures assign patents to a research and
development division separate from the operations division responsible
for ETS-regulated activities. Second, even this more generous labeling
strategy will not account for situations in which CITL emitters have
wholly-owned subsidiaries with completely different names, who may be
involved in innovation activities. Hence the matches reported here
represent, at best, a conservative estimate of the true web of
connections between innovation activity and direct exposure to
emissions pricing. Third, many emitting firms may collaborate with
suppliers on innovation, even if they are not listed as coauthors on
patents themselves. Hence, for instance, Siemens may conduct
significant research and development in collaboration with its power
generation technology customers, but those links may not show up in the patents
filed to protect the results of that R\&D. These issues--some of which
go well beyond the problem of identifying likely matches between CITL
and PATSTAT entities--may therefore understate the scope of the
entities affected by ETS regulation.

We note that the classifier, once trained, should be useful for some
period into the future. Having trained the classifier on thousands of
potential record pairs, the relative degree of additional variance
introduced by either new CITL account holders or new inventors in the
PATSTAT database should be low. Hence the classification approach
presented here should permit ongoing updates to the record linkage
estimates without substantial further investment in human coding
effort.\footnote{We are pursuing the use of additional data in the
  classifier. In particular, we hope to develop a means of associating
inventors to economic sectors based on the technology categories in
which they innovate. Since the CITL data have economic sector as well,
this would permit matching not only to name and place, but economic
activity as well. This would help distinguish, in particular, name
differences due to minor spelling errors from name differences due to
real distinctions among firms. This work is presently ongoing.}

\subsection{Results and descriptive statistics}
\label{sec:descr-stat}

We present three measures of match coverage. First, as figure
\ref{fig:citl-match-pct} shows, member states' proportion of CITL
account holders with positive PATSTAT matches varied from zero percent
at the low end (for Latvia and Lithuania) to over forty percent for
the Netherlands and Italy. Second, as table \ref{tab:pct-match-bytype}
shows, match rates varied widely across economic sectors. Bulk
chemicals firms and steel manufacturers were the most likely to have
records in the innovation database. In contrast, airlines and small
power plant operators were least likely. Finally, figure
\ref{fig:citl-match-pct-bytype} shows that these match rates break
down by the CITL installation classifications.

These results comport with a fairly simple prior expectation
for innovation across different economic sectors. Large industrial
chemical and specialty metallurgy firms invest in a variety of patentable process
and product innovations. In contrast, while airlines may identify how
new technologies might help serve new markets, they nevertheless buy
most of that technology from a handful of major international suppliers,
while focusing their internal efforts on operational efficiency.\footnote{See here, for instance,
  \cite{brueckner2009technological}, who note that most capital
  innovation in the airline industry comes from suppliers, rather than
  operators; while operational innovations derive from new technological
  capabilities.} Hence we would expect substantial variation in
PATSTAT:CITL match rates both within countries (consequence of sectoral variation
in innovation activity) and between countries (consequence of variance
in industrial specialization and innovative activity). 

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{citl_match_pct_overall}
  \caption{Proportion of CITL account holders with positive PATSTAT match. This figure illustrates the overall proportion of CITL account holders in each country for which a positive match to a PATSTAT inventor was found.}
  \label{fig:citl-match-pct}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{citl_match_pct_bytype}
  \caption{Proportion of CITL account holders with positive PATSTAT matches, by country and installation type. This figure illustrates the overall proportion of CITL account holders in each country for which a positive match to a PATSTAT inventor was found, broken out by the type of installation. Installation types correspond to the CITL installation type registry.}
  \label{fig:citl-match-pct-bytype}
\end{figure}

\input{../tables/pct_patstat_citl_match_bytype}
%% Overall accuracy and accuracy estimates by country
%% Sample names
%% Estimated cross-validated accuracy +/-
%% Other?

\section{Conclusions}
\label{sec:conclusions}

We have demonstrated a relatively straightforward method of tying firm
innovation activities to their regulatory exposure in the European
Emissions Trading Scheme. We demonstrate that this method performs
well against manually-checked records. We suggest, however, that this
effort remains incomplete given the likelihood of complex corporate
structures that are not amenable to record linkage based on
comparisons of name and geography alone. Hence the results presented
here provide a conservative estimate of the degree of innovative
activity among regulated firms. We propose, and are pursuing,
additional data on economic sector and operations that may assist in
improving these matches.

\bibliography{/home/markhuberty/bibs/patstat_dedupe}
\bibliographystyle{apalike}
\end{document}